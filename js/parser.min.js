Array.indexOf||(Array.prototype.indexOf=function(t,s){for(var i=s||0;i<this.length;i++)if(this[i]===t)return i;return-1});var Parser=function(t){function s(t){function s(){}return s.prototype=t,new s}function i(t,s,i,e){this.type_=t,this.index_=s||0,this.prio_=i||0,this.number_=void 0!==e&&null!==e?e:0,this.toString=function(){switch(this.type_){case j:return this.number_;case F:case U:case B:return this.index_;case R:return"CALL";default:return"Invalid Token"}}}function e(t,s,i,e){this.tokens=t,this.ops1=s,this.ops2=i,this.functions=e}function n(t){return"string"==typeof t?(V.lastIndex=0,V.test(t)?"'"+t.replace(V,function(t){var s=W[t];return"string"==typeof s?s:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+"'":"'"+t+"'"):t}function r(t,s){return Number(t)+Number(s)}function o(t,s){return t-s}function h(t,s){return t*s}function a(t,s){return t/s}function p(t,s){return t%s}function u(t,s){return""+t+s}function f(t,s){return t==s}function c(t,s){return t!=s}function l(t,s){return t>s}function d(t,s){return s>t}function g(t,s){return t>=s}function k(t,s){return s>=t}function v(t,s){return Boolean(t&&s)}function M(t,s){return Boolean(t||s)}function m(t){return Math.sinh?Math.sinh(t):(Math.exp(t)-Math.exp(-t))/2}function _(t){return Math.cosh?Math.cosh(t):(Math.exp(t)+Math.exp(-t))/2}function b(t){return Math.tanh?Math.tanh(t):t===1/0?1:t===-(1/0)?-1:(Math.exp(t)-Math.exp(-t))/(Math.exp(t)+Math.exp(-t))}function w(t){return Math.asinh?Math.asinh(t):t===-(1/0)?t:Math.log(t+Math.sqrt(t*t+1))}function y(t){return Math.acosh?Math.acosh(t):Math.log(t+Math.sqrt(t*t-1))}function C(t){return Math.atanh?Math.atanh(t):Math.log((1+t)/(1-t))/2}function A(t){return Math.log(t)*Math.LOG10E}function E(t){return-t}function S(t){return Math.trunc?Math.trunc(t):x<0?Math.ceil(x):Math.floor(x)}function O(t){return Math.random()*(t||1)}function P(t){t=Math.floor(t);for(var s=t;t>1;)s*=--t;return s}function q(){if(Math.hypot)return Math.hypot.apply(this,arguments);for(var t=0,s=arguments.length,i=0;s>i;i++){if(arguments[i]===1/0||arguments[i]===-(1/0))return 1/0;t+=arguments[i]*arguments[i]}return Math.sqrt(t)}function I(t,s,i){return t?s:i}function L(t,s){return"[object Array]"!=Object.prototype.toString.call(t)?[t,s]:(t=t.slice(),t.push(s),t)}function N(){this.success=!1,this.errormsg="",this.expression="",this.pos=0,this.tokennumber=0,this.tokenprio=0,this.tokenindex=0,this.tmpprio=0,this.ops1={sin:Math.sin,cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,sinh:m,cosh:_,tanh:b,asinh:w,acosh:y,atanh:C,sqrt:Math.sqrt,log:Math.log,lg:A,log10:A,abs:Math.abs,ceil:Math.ceil,floor:Math.floor,round:Math.round,trunc:S,"-":E,exp:Math.exp},this.ops2={"+":r,"-":o,"*":h,"/":a,"%":p,"^":Math.pow,",":L,"||":u,"==":f,"!=":c,">":l,"<":d,">=":g,"<=":k,and:v,or:M},this.functions={random:O,fac:P,min:Math.min,max:Math.max,hypot:q,pyt:q,pow:Math.pow,atan2:Math.atan2,"if":I},this.consts={E:Math.E,PI:Math.PI}}var j=0,F=1,U=2,B=3,R=4,V=/[\\\'\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,W={"\b":"\\b"," ":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","'":"\\'","\\":"\\\\"};e.prototype={simplify:function(t){t=t||{};var n,r,o,h,a=[],p=[],u=this.tokens.length,f=0;for(f=0;u>f;f++){h=this.tokens[f];var c=h.type_;if(c===j)a.push(h);else if(c===B&&h.index_ in t)h=new i(j,0,0,t[h.index_]),a.push(h);else if(c===U&&a.length>1)r=a.pop(),n=a.pop(),o=this.ops2[h.index_],h=new i(j,0,0,o(n.number_,r.number_)),a.push(h);else if(c===F&&a.length>0)n=a.pop(),o=this.ops1[h.index_],h=new i(j,0,0,o(n.number_)),a.push(h);else{for(;a.length>0;)p.push(a.shift());p.push(h)}}for(;a.length>0;)p.push(a.shift());return new e(p,s(this.ops1),s(this.ops2),s(this.functions))},substitute:function(t,n){n instanceof e||(n=(new N).parse(String(n)));var r,o=[],h=this.tokens.length,a=0;for(a=0;h>a;a++){r=this.tokens[a];var p=r.type_;if(p===B&&r.index_===t)for(var u=0;u<n.tokens.length;u++){var f=n.tokens[u],c=new i(f.type_,f.index_,f.prio_,f.number_);o.push(c)}else o.push(r)}var l=new e(o,s(this.ops1),s(this.ops2),s(this.functions));return l},evaluate:function(t){t=t||{};var s,i,e,n,r=[],o=this.tokens.length,h=0;for(h=0;o>h;h++){n=this.tokens[h];var a=n.type_;if(a===j)r.push(n.number_);else if(a===U)i=r.pop(),s=r.pop(),e=this.ops2[n.index_],r.push(e(s,i));else if(a===B)if(n.index_ in t)r.push(t[n.index_]);else{if(!(n.index_ in this.functions))throw new Error("undefined variable: "+n.index_);r.push(this.functions[n.index_])}else if(a===F)s=r.pop(),e=this.ops1[n.index_],r.push(e(s));else{if(a!==R)throw new Error("invalid Expression");if(s=r.pop(),e=r.pop(),!e.apply||!e.call)throw new Error(e+" is not a function");r.push("[object Array]"==Object.prototype.toString.call(s)?e.apply(void 0,s):e.call(void 0,s))}}if(r.length>1)throw new Error("invalid Expression (parity)");return r[0]},toString:function(t){var s,i,e,r,o=[],h=this.tokens.length,a=0;for(a=0;h>a;a++){r=this.tokens[a];var p=r.type_;if(p===j)o.push(n(r.number_));else if(p===U)i=o.pop(),s=o.pop(),e=r.index_,o.push(t&&"^"==e?"Math.pow("+s+","+i+")":"("+s+e+i+")");else if(p===B)o.push(r.index_);else if(p===F)s=o.pop(),e=r.index_,o.push("-"===e?"("+e+s+")":e+"("+s+")");else{if(p!==R)throw new Error("invalid Expression");s=o.pop(),e=o.pop(),o.push(e+"("+s+")")}}if(o.length>1)throw new Error("invalid Expression (parity)");return o[0]},variables:function(){for(var t=this.tokens.length,s=[],i=0;t>i;i++){var e=this.tokens[i];e.type_===B&&-1==s.indexOf(e.index_)&&s.push(e.index_)}return s},toJSFunction:function(t,s){var i=new Function(t,"with(Parser.values) { return "+this.simplify(s).toString(!0)+"; }");return i}},N.parse=function(t){return(new N).parse(t)},N.evaluate=function(t,s){return N.parse(t).evaluate(s)},N.Expression=e,N.values={sin:Math.sin,cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,sinh:m,cosh:_,tanh:b,asinh:w,acosh:y,atanh:C,sqrt:Math.sqrt,log:Math.log,lg:A,log10:A,abs:Math.abs,ceil:Math.ceil,floor:Math.floor,round:Math.round,trunc:S,random:O,fac:P,exp:Math.exp,min:Math.min,max:Math.max,hypot:q,pyt:q,pow:Math.pow,atan2:Math.atan2,"if":I,E:Math.E,PI:Math.PI};var G=1,J=2,T=4,z=8,D=16,H=32,K=64,Q=128,X=256;return N.prototype={parse:function(t){this.errormsg="",this.success=!0;var n=[],r=[];this.tmpprio=0;var o=G|z|T|K,h=0;for(this.expression=t,this.pos=0;this.pos<this.expression.length;)if(this.isOperator())this.isSign()&&o&K?(this.isNegativeSign()&&(this.tokenprio=2,this.tokenindex="-",h++,this.addfunc(r,n,F)),o=G|z|T|K):this.isComment()||(0===(o&J)&&this.error_parsing(this.pos,"unexpected operator"),h+=2,this.addfunc(r,n,U),o=G|z|T|K);else if(this.isNumber()){0===(o&G)&&this.error_parsing(this.pos,"unexpected number");var a=new i(j,0,0,this.tokennumber);r.push(a),o=J|D|H}else if(this.isString()){0===(o&G)&&this.error_parsing(this.pos,"unexpected string");var a=new i(j,0,0,this.tokennumber);r.push(a),o=J|D|H}else if(this.isLeftParenth())0===(o&z)&&this.error_parsing(this.pos,'unexpected "("'),o&Q&&(h+=2,this.tokenprio=-2,this.tokenindex=-1,this.addfunc(r,n,R)),o=G|z|T|K|X;else if(this.isRightParenth()){if(o&X){var a=new i(j,0,0,[]);r.push(a)}else 0===(o&D)&&this.error_parsing(this.pos,'unexpected ")"');o=J|D|H|z|Q}else if(this.isComma())0===(o&H)&&this.error_parsing(this.pos,'unexpected ","'),this.addfunc(r,n,U),h+=2,o=G|z|T|K;else if(this.isConst()){0===(o&G)&&this.error_parsing(this.pos,"unexpected constant");var p=new i(j,0,0,this.tokennumber);r.push(p),o=J|D|H}else if(this.isOp2())0===(o&T)&&this.error_parsing(this.pos,"unexpected function"),this.addfunc(r,n,U),h+=2,o=z;else if(this.isOp1())0===(o&T)&&this.error_parsing(this.pos,"unexpected function"),this.addfunc(r,n,F),h++,o=z;else if(this.isVar()){0===(o&G)&&this.error_parsing(this.pos,"unexpected variable");var u=new i(B,this.tokenindex,0,0);r.push(u),o=J|D|H|z|Q}else this.isWhite()||(""===this.errormsg?this.error_parsing(this.pos,"unknown character"):this.error_parsing(this.pos,this.errormsg));for((this.tmpprio<0||this.tmpprio>=10)&&this.error_parsing(this.pos,'unmatched "()"');n.length>0;){var f=n.pop();r.push(f)}return h+1!==r.length&&this.error_parsing(this.pos,"parity"),new e(r,s(this.ops1),s(this.ops2),s(this.functions))},evaluate:function(t,s){return this.parse(t).evaluate(s)},error_parsing:function(t,s){throw this.success=!1,this.errormsg="parse error [column "+t+"]: "+s,this.column=t,new Error(this.errormsg)},addfunc:function(t,s,e){for(var n=new i(e,this.tokenindex,this.tokenprio+this.tmpprio,0);s.length>0&&n.prio_<=s[s.length-1].prio_;)t.push(s.pop());s.push(n)},isNumber:function(){for(var t=!1,s="";this.pos<this.expression.length;){var i=this.expression.charCodeAt(this.pos);if(!(i>=48&&57>=i||46===i))break;s+=this.expression.charAt(this.pos),this.pos++,this.tokennumber=parseFloat(s),t=!0}return t},unescape:function(t,s){for(var i=[],e=!1,n=0;n<t.length;n++){var r=t.charAt(n);if(e){switch(r){case"'":i.push("'");break;case"\\":i.push("\\");break;case"/":i.push("/");break;case"b":i.push("\b");break;case"f":i.push("\f");break;case"n":i.push("\n");break;case"r":i.push("\r");break;case"t":i.push("  ");break;case"u":var o=parseInt(t.substring(n+1,n+5),16);i.push(String.fromCharCode(o)),n+=4;break;default:throw this.error_parsing(s+n,"Illegal escape sequence: '\\"+r+"'")}e=!1}else"\\"==r?e=!0:i.push(r)}return i.join("")},isString:function(){var t=!1,s="",i=this.pos;if(this.pos<this.expression.length&&"'"==this.expression.charAt(this.pos))for(this.pos++;this.pos<this.expression.length;){var e=this.expression.charAt(this.pos);if("'"==e&&"\\"!=s.slice(-1)){this.pos++,this.tokennumber=this.unescape(s,i),t=!0;break}s+=this.expression.charAt(this.pos),this.pos++}return t},isConst:function(){var t;for(var s in this.consts){var i=s.length;if(t=this.expression.substr(this.pos,i),s===t)return this.tokennumber=this.consts[s],this.pos+=i,!0}return!1},isOperator:function(){var t=this.expression.charCodeAt(this.pos);if(43===t)this.tokenprio=2,this.tokenindex="+";else if(45===t)this.tokenprio=2,this.tokenindex="-";else if(62===t)61===this.expression.charCodeAt(this.pos+1)?(this.pos++,this.tokenprio=1,this.tokenindex=">="):(this.tokenprio=1,this.tokenindex=">");else if(60===t)61===this.expression.charCodeAt(this.pos+1)?(this.pos++,this.tokenprio=1,this.tokenindex="<="):(this.tokenprio=1,this.tokenindex="<");else if(124===t){if(124!==this.expression.charCodeAt(this.pos+1))return!1;this.pos++,this.tokenprio=1,this.tokenindex="||"}else if(61===t){if(61!==this.expression.charCodeAt(this.pos+1))return!1;this.pos++,this.tokenprio=1,this.tokenindex="=="}else if(33===t){if(61!==this.expression.charCodeAt(this.pos+1))return!1;this.pos++,this.tokenprio=1,this.tokenindex="!="}else if(97===t){if(110!==this.expression.charCodeAt(this.pos+1)||100!==this.expression.charCodeAt(this.pos+2))return!1;this.pos++,this.pos++,this.tokenprio=0,this.tokenindex="and"}else if(111===t){if(114!==this.expression.charCodeAt(this.pos+1))return!1;this.pos++,this.tokenprio=0,this.tokenindex="or"}else if(42===t||8729===t||8226===t)this.tokenprio=3,this.tokenindex="*";else if(47===t)this.tokenprio=4,this.tokenindex="/";else if(37===t)this.tokenprio=4,this.tokenindex="%";else{if(94!==t)return!1;this.tokenprio=5,this.tokenindex="^"}return this.pos++,!0},isSign:function(){var t=this.expression.charCodeAt(this.pos-1);return 45===t||43===t?!0:!1},isPositiveSign:function(){var t=this.expression.charCodeAt(this.pos-1);return 43===t?!0:!1},isNegativeSign:function(){var t=this.expression.charCodeAt(this.pos-1);return 45===t?!0:!1},isLeftParenth:function(){var t=this.expression.charCodeAt(this.pos);return 40===t?(this.pos++,this.tmpprio+=10,!0):!1},isRightParenth:function(){var t=this.expression.charCodeAt(this.pos);return 41===t?(this.pos++,this.tmpprio-=10,!0):!1},isComma:function(){var t=this.expression.charCodeAt(this.pos);return 44===t?(this.pos++,this.tokenprio=-1,this.tokenindex=",",!0):!1},isWhite:function(){var t=this.expression.charCodeAt(this.pos);return 32===t||9===t||10===t||13===t?(this.pos++,!0):!1},isOp1:function(){for(var t="",s=this.pos;s<this.expression.length;s++){var i=this.expression.charAt(s);if(i.toUpperCase()===i.toLowerCase()&&(s===this.pos||"_"!=i&&("0">i||i>"9")))break;t+=i}return t.length>0&&t in this.ops1?(this.tokenindex=t,this.tokenprio=5,this.pos+=t.length,!0):!1},isOp2:function(){for(var t="",s=this.pos;s<this.expression.length;s++){var i=this.expression.charAt(s);if(i.toUpperCase()===i.toLowerCase()&&(s===this.pos||"_"!=i&&("0">i||i>"9")))break;t+=i}return t.length>0&&t in this.ops2?(this.tokenindex=t,this.tokenprio=5,this.pos+=t.length,!0):!1},isVar:function(){for(var t="",s=this.pos;s<this.expression.length;s++){var i=this.expression.charAt(s);if(i.toUpperCase()===i.toLowerCase()&&(s===this.pos||"_"!=i&&("0">i||i>"9")))break;t+=i}return t.length>0?(this.tokenindex=t,this.tokenprio=4,this.pos+=t.length,!0):!1},isComment:function(){var t=this.expression.charCodeAt(this.pos-1);return 47===t&&42===this.expression.charCodeAt(this.pos)?(this.pos=this.expression.indexOf("*/",this.pos)+2,1===this.pos&&(this.pos=this.expression.length),!0):!1}},t.Parser=N,N}("undefined"==typeof exports?{}:exports);
